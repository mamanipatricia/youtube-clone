/*
 *             Copyright (c) 2016 - 2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0xc873=['data','model','_getOutlineDefinitions','document','includes','getChildren','get','change','push','_deriveHeadingElementsFromConversion','pluginName','indexOf','_headingNames','getRootNames','_getActiveHeading','afterInit','length','createElement','fire','backward','editor','item','level','_getHeadingNames','text','toModel','domConverter','modelElement','getChild','selection','init','name','view','element'];(function(_0x386312,_0xc8734a){const _0x2408a2=function(_0x14e865){while(--_0x14e865){_0x386312['push'](_0x386312['shift']());}};_0x2408a2(++_0xc8734a);}(_0xc873,0x151));const _0x2408=function(_0x386312,_0xc8734a){_0x386312=_0x386312-0x0;let _0x2408a2=_0xc873[_0x386312];return _0x2408a2;};import{Plugin as _0x14c693}from'ckeditor5/src/core';import{debounce as _0xf03259}from'lodash-es';import{TreeWalker as _0x2c3077}from'ckeditor5/src/engine';import{getElementText as _0xa09c59,getDefaultFeatureHeadingNames as _0x6d99d3}from'./utils';import{diff as _0x260696,diffToChanges as _0x3c62c5}from'ckeditor5/src/utils';export default class n extends _0x14c693{constructor(){super(...arguments),this[_0x2408('0xf')]=[];}static get[_0x2408('0xd')](){return'DocumentOutlineUtils';}[_0x2408('0x21')](){const _0x207e7b=this['editor'];this[_0x2408('0xf')]=this[_0x2408('0x1a')]();let _0x498430=[];_0x207e7b[_0x2408('0x4')][_0x2408('0x6')]['on'](_0x2408('0xa'),_0xf03259(()=>{const _0x1fa2e7=_0x498430;_0x498430=this['_getOutlineDefinitions']();const _0x47fa0f=_0x260696(_0x1fa2e7,_0x498430,(_0x1e944d,_0x55327d)=>_0x1e944d[_0x2408('0x19')]===_0x55327d[_0x2408('0x19')]&&_0x1e944d[_0x2408('0x1b')]===_0x55327d['text']&&_0x1e944d[_0x2408('0x1e')]===_0x55327d[_0x2408('0x1e')]),_0x390acd=_0x3c62c5(_0x47fa0f,_0x498430),_0x2133cb=this[_0x2408('0x11')](),_0x34aca4=_0x498430['findIndex'](_0x2d050a=>_0x2d050a[_0x2408('0x1e')]===_0x2133cb);_0x390acd[_0x2408('0x13')]&&this[_0x2408('0x15')](_0x2408('0xa'),{'outlineDefinitions':_0x498430,'activeItemIndex':_0x34aca4,'outlineChanges':_0x390acd}),this[_0x2408('0x15')]('activeItemIndex',{'index':_0x34aca4});},0xfa,{'leading':!0x0,'trailing':!0x0}));}[_0x2408('0x12')](){this[_0x2408('0xf')][_0x2408('0x13')]||this[_0x2408('0xc')]();}[_0x2408('0x5')](){const _0x713817=this[_0x2408('0x17')],_0x73fd7e=[],_0x527f47=this[_0x2408('0xf')];for(const _0x2763de of _0x713817[_0x2408('0x4')][_0x2408('0x6')][_0x2408('0x10')]())_0x2d839c(_0x713817[_0x2408('0x4')][_0x2408('0x6')]['getRoot'](_0x2763de));function _0x2d839c(_0x50db75){for(const _0x112b81 of _0x50db75[_0x2408('0x8')]())_0x112b81['is'](_0x2408('0x2'))&&(_0x527f47['includes'](_0x112b81[_0x2408('0x0')])&&_0x73fd7e[_0x2408('0xb')]({'level':_0x527f47[_0x2408('0xe')](_0x112b81[_0x2408('0x0')])+0x1,'text':_0xa09c59(_0x112b81),'modelElement':_0x112b81}),_0x2d839c(_0x112b81));}return _0x73fd7e;}['_getActiveHeading'](){const _0x2a433f=this[_0x2408('0x17')][_0x2408('0x4')][_0x2408('0x6')][_0x2408('0x20')]['getFirstPosition'](),_0x3c246e=new _0x2c3077({'direction':_0x2408('0x16'),'startPosition':_0x2a433f});for(const _0x335df4 of _0x3c246e)if(_0x335df4[_0x2408('0x18')]['is'](_0x2408('0x2'))&&this[_0x2408('0xf')][_0x2408('0x7')](_0x335df4[_0x2408('0x18')][_0x2408('0x0')]))return _0x335df4['item'];}[_0x2408('0x1a')](){const _0x1bff0e=this[_0x2408('0x17')]['config'][_0x2408('0x9')]('documentOutline.headings');return _0x1bff0e||_0x6d99d3(this[_0x2408('0x17')]);}['_deriveHeadingElementsFromConversion'](){const _0x1f47ba=this[_0x2408('0x17')],_0x451ffc=['h1','h2','h3','h4','h5','h6'],_0x13f30a=[];for(const _0x4ed10b of _0x451ffc){const _0x5e793a=_0x1f47ba['editing'][_0x2408('0x1')][_0x2408('0x1d')]['domToView'](document[_0x2408('0x14')](_0x4ed10b)),_0x3d1996=_0x1f47ba[_0x2408('0x3')][_0x2408('0x1c')](_0x5e793a)[_0x2408('0x1f')](0x0);(null==_0x3d1996?void 0x0:_0x3d1996['is'](_0x2408('0x2')))&&_0x13f30a['push'](_0x3d1996[_0x2408('0x0')]);}this[_0x2408('0xf')]=_0x13f30a;}}